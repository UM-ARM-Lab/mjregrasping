<mujoco model="untangle">
    <default>
        <joint stiffness="0.5"/>
        <geom friction="0.0002"/>
        <default class="visual">
            <!-- any geom with the class "visual" will not collide with anything -->
            <geom contype="0" conaffinity="0" group="2"/>
        </default>
    </default>
    <include file="materials.xml"/>
    <include file="val.xml"/>
    <!-- override the high viscosity used in sim experiments because it's unrealistic -->
    <option viscosity="0.002" timestep="0.004"/>
    <include file="real_obs.xml"/>
    <include file="floor.xml"/>
    <include file="cc_sphere.xml"/>
    <worldbody>
        <!-- real rope is 1.24m but since our table top is slightly oversized, we also increase rope length -->
        <body name="rope" pos="0.39 0.844 0.74" euler="0.25 -1.4 0">
            <inertial pos="0 0 0" quat="1 0 0 0" mass="0.30" diaginertia="0.002 0.002 0.002"/>
            <joint type="free" damping="1000"/>
            <body name="B_first">
                <joint name="J_first" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                <geom name="G0" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                      friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                <site name="S_first" pos="0 0 0" group="3"/>
                <body name="B_1" pos="0.0529167 0 0">
                    <joint name="J_1" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                    <geom name="G1" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                          friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                    <body name="B_2" pos="0.0529167 0 0">
                        <joint name="J_2" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                        <geom name="G2" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                              friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                        <body name="B_3" pos="0.0529167 0 0">
                            <joint name="J_3" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                            <geom name="G3" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0" type="capsule"
                                  condim="1" friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                            <body name="B_4" pos="0.0529166 0 0">
                                <joint name="J_4" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                                <geom name="G4" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0" type="capsule"
                                      condim="1" friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                <body name="B_5" pos="0.0529167 0 0">
                                    <joint name="J_5" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                                    <geom name="G5" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0" type="capsule"
                                          condim="1" friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                    <body name="B_6" pos="0.0529167 0 0">
                                        <joint name="J_6" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                                        <geom name="G6" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0"
                                              type="capsule" condim="1" friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                        <body name="B_7" pos="0.0529167 0 0">
                                            <joint name="J_7" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                                            <geom name="G7" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0"
                                                  type="capsule" condim="1" friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                            <body name="B_8" pos="0.0529166 0 0">
                                                <joint name="J_8" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                                                <geom name="G8" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0"
                                                      type="capsule" condim="1" friction="1 0.005 0.0001" solref="0.02 1"
                                                      rgba="0.8 0.2 0.1 1"/>
                                                <body name="B_9" pos="0.0529166 0 0">
                                                    <joint name="J_9" pos="0 0 0" type="ball" group="3" stiffness="0.02" damping="0.05"/>
                                                    <geom name="G9" size="0.007 0.0264583" pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0"
                                                          type="capsule" condim="1" friction="1 0.005 0.0001" solref="0.02 1"
                                                          rgba="0.8 0.2 0.1 1"/>
                                                    <body name="B_10" pos="0.0529167 0 0">
                                                        <joint name="J_10" pos="0 0 0" type="ball" group="3" stiffness="0.02"
                                                               damping="0.05"/>
                                                        <geom name="G10" size="0.007 0.0264584" pos="0.0264584 0 0"
                                                              quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                                                              friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                                        <body name="B_11" pos="0.0529166 0 0">
                                                            <joint name="J_11" pos="0 0 0" type="ball" group="3" stiffness="0.02"
                                                                   damping="0.05"/>
                                                            <geom name="G11" size="0.007 0.0264583" pos="0.0264583 0 0"
                                                                  quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                                                                  friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                                            <body name="B_12" pos="0.0529167 0 0">
                                                                <joint name="J_12" pos="0 0 0" type="ball" group="3" stiffness="0.02"
                                                                       damping="0.05"/>
                                                                <geom name="G12" size="0.007 0.0264584" pos="0.0264584 0 0"
                                                                      quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                                                                      friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                                                <body name="B_13" pos="0.0529166 0 0">
                                                                    <joint name="J_13" pos="0 0 0" type="ball" group="3" stiffness="0.02"
                                                                           damping="0.05"/>
                                                                    <geom name="G13" size="0.007 0.0264583" pos="0.0264583 0 0"
                                                                          quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                                                                          friction="1 0.005 0.0001" solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                                                    <body name="B_14" pos="0.0529166 0 0">
                                                                        <joint name="J_14" pos="0 0 0" type="ball" group="3"
                                                                               stiffness="0.02" damping="0.05"/>
                                                                        <geom name="G14" size="0.007 0.0264583" pos="0.0264583 0 0"
                                                                              quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                                                                              friction="1 0.005 0.0001" solref="0.02 1"
                                                                              rgba="0.8 0.2 0.1 1"/>
                                                                        <body name="B_15" pos="0.0529167 0 0">
                                                                            <joint name="J_15" pos="0 0 0" type="ball" group="3"
                                                                                   stiffness="0.02" damping="0.05"/>
                                                                            <geom name="G15" size="0.007 0.0264584" pos="0.0264584 0 0"
                                                                                  quat="0.707107 0 -0.707107 0" type="capsule" condim="1"
                                                                                  friction="1 0.005 0.0001" solref="0.02 1"
                                                                                  rgba="0.8 0.2 0.1 1"/>
                                                                            <body name="B_16" pos="0.0529166 0 0">
                                                                                <joint name="J_16" pos="0 0 0" type="ball" group="3"
                                                                                       stiffness="0.02" damping="0.05"/>
                                                                                <geom name="G16" size="0.007 0.0264583" pos="0.0264583 0 0"
                                                                                      quat="0.707107 0 -0.707107 0" type="capsule"
                                                                                      condim="1" friction="1 0.005 0.0001" solref="0.02 1"
                                                                                      rgba="0.8 0.2 0.1 1"/>
                                                                                <body name="B_17" pos="0.0529166 0 0">
                                                                                    <joint name="J_17" pos="0 0 0" type="ball" group="3"
                                                                                           stiffness="0.02" damping="0.05"/>
                                                                                    <geom name="G17" size="0.007 0.0264583"
                                                                                          pos="0.0264583 0 0" quat="0.707107 0 -0.707107 0"
                                                                                          type="capsule" condim="1"
                                                                                          friction="1 0.005 0.0001" solref="0.02 1"
                                                                                          rgba="0.8 0.2 0.1 1"/>
                                                                                    <body name="B_18" pos="0.0529166 0 0">
                                                                                        <joint name="J_18" pos="0 0 0" type="ball" group="3"
                                                                                               stiffness="0.02" damping="0.05"/>
                                                                                        <geom name="G18" size="0.007 0.0264583"
                                                                                              pos="0.0264583 0 0"
                                                                                              quat="0.707107 0 -0.707107 0" type="capsule"
                                                                                              condim="1" friction="1 0.005 0.0001"
                                                                                              solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                                                                        <body name="B_19" pos="0.0529166 0 0">
                                                                                            <joint name="J_19" pos="0 0 0" type="ball"
                                                                                                   group="3" stiffness="0.02"
                                                                                                   damping="0.05"/>
                                                                                            <geom name="G19" size="0.007 0.0264583"
                                                                                                  pos="0.0264583 0 0"
                                                                                                  quat="0.707107 0 -0.707107 0"
                                                                                                  type="capsule" condim="1"
                                                                                                  friction="1 0.005 0.0001" solref="0.02 1"
                                                                                                  rgba="0.8 0.2 0.1 1"/>
                                                                                            <body name="B_20" pos="0.0529168 0 0">
                                                                                                <joint name="J_20" pos="0 0 0" type="ball"
                                                                                                       group="3" stiffness="0.02"
                                                                                                       damping="0.05"/>
                                                                                                <geom name="G20" size="0.007 0.0264584"
                                                                                                      pos="0.0264584 0 0"
                                                                                                      quat="0.707107 0 -0.707107 0"
                                                                                                      type="capsule" condim="1"
                                                                                                      friction="1 0.005 0.0001"
                                                                                                      solref="0.02 1" rgba="0.8 0.2 0.1 1"/>
                                                                                                <body name="B_21" pos="0.0529166 0 0">
                                                                                                    <joint name="J_21" pos="0 0 0"
                                                                                                           type="ball" group="3"
                                                                                                           stiffness="0.02" damping="0.05"/>
                                                                                                    <geom name="G21" size="0.007 0.0264583"
                                                                                                          pos="0.0264583 0 0"
                                                                                                          quat="0.707107 0 -0.707107 0"
                                                                                                          type="capsule" condim="1"
                                                                                                          friction="1 0.005 0.0001"
                                                                                                          solref="0.02 1"
                                                                                                          rgba="0.8 0.2 0.1 1"/>
                                                                                                    <body name="B_22" pos="0.0529166 0 0">
                                                                                                        <joint name="J_22" pos="0 0 0"
                                                                                                               type="ball" group="3"
                                                                                                               stiffness="0.02"
                                                                                                               damping="0.05"/>
                                                                                                        <geom name="G22"
                                                                                                              size="0.007 0.0264583"
                                                                                                              pos="0.0264583 0 0"
                                                                                                              quat="0.707107 0 -0.707107 0"
                                                                                                              type="capsule" condim="1"
                                                                                                              friction="1 0.005 0.0001"
                                                                                                              solref="0.02 1"
                                                                                                              rgba="0.8 0.2 0.1 1"/>
                                                                                                        <body name="B_last"
                                                                                                              pos="0.0529166 0 0">
                                                                                                            <joint name="J_last" pos="0 0 0"
                                                                                                                   type="ball" group="3"
                                                                                                                   stiffness="0.02"
                                                                                                                   damping="0.05"/>
                                                                                                            <geom name="G23"
                                                                                                                  size="0.007 0.0264583"
                                                                                                                  pos="0.0264583 0 0"
                                                                                                                  quat="0.707107 0 -0.707107 0"
                                                                                                                  type="capsule" condim="1"
                                                                                                                  friction="1 0.005 0.0001"
                                                                                                                  solref="0.02 1"
                                                                                                                  rgba="0.8 0.2 0.1 1"/>
                                                                                                            <site name="S_last"
                                                                                                                  pos="0.0529166 0 0"
                                                                                                                  group="3"/>
                                                                                                            <geom name="tip"
                                                                                                                  pos="0.07 0 0"
                                                                                                                  type="sphere"
                                                                                                                  size="0.015"
                                                                                                                  rgba="0.8 0.2 0.1 1"/>
                                                                                                        </body>
                                                                                                    </body>
                                                                                                </body>
                                                                                            </body>
                                                                                        </body>
                                                                                    </body>
                                                                                </body>
                                                                            </body>
                                                                        </body>
                                                                    </body>
                                                                </body>
                                                            </body>
                                                        </body>
                                                    </body>
                                                </body>
                                            </body>
                                        </body>
                                    </body>
                                </body>
                            </body>
                        </body>
                    </body>
                </body>
            </body>
        </body>
        <!-- used for recording what happens in the simulation -->
        <body name="mycamera">
            <camera mode="fixed" name="mycamera" xyaxes="1 -0.4 0 0 1 1" pos="-0.3 -0.5 1.4"/>
        </body>
        <light name="overhead1" pos="0 0 10" mode="trackcom"/>
    </worldbody>
    <equality>
        <connect body1="drive50" body2="B_first" name="left" anchor="0 0 0.10" active="false" solref="0.04 1"/>
        <connect body1="drive10" body2="B_first" name="right" anchor="0 0 0.10" active="false" solref="0.04 1"/>

        <connect body1="attach" body2="B_first" name="attach" anchor="0 0 0" active="true" solref="0.01 1"/>

        <!-- constraints to pull the mujoco rope towards where CDCPD says the rope is -->
        <connect body1="world" body2="B_first" name="B_0" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_1" name="B_1" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_2" name="B_2" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_3" name="B_3" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_4" name="B_4" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_5" name="B_5" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_6" name="B_6" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_7" name="B_7" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_8" name="B_8" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_9" name="B_9" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_10" name="B_10" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_11" name="B_11" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_12" name="B_12" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_13" name="B_13" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_14" name="B_14" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_15" name="B_15" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_16" name="B_16" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_17" name="B_17" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_18" name="B_18" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_19" name="B_19" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_20" name="B_20" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_21" name="B_21" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_22" name="B_22" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_last" name="B_23" anchor="0 0 0" active="false" solref="0.1 1"/>
        <connect body1="world" body2="B_last" name="B_24" anchor="0 0 0" active="false" solref="0.1 1"/>
    </equality>
</mujoco>
